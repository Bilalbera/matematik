<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Roblox UI Titan v2.7 - Ultimate Edition</title>
    <style>
        :root { --primary: #00a2ff; --bg: #0d0d0d; --panel: #181818; --border: #333; --accent: #2ecc71; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: white; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* PANELLER */
        .sidebar { width: 240px; background: var(--panel); border-right: 1px solid var(--border); padding: 15px; display: flex; flex-direction: column; gap: 8px; z-index: 100; flex-shrink: 0; }
        .properties { width: 330px; background: var(--panel); border-left: 1px solid var(--border); padding: 15px; overflow-y: auto; height: 100vh; display: flex; flex-direction: column; gap: 12px; flex-shrink: 0; box-sizing: border-box; padding-bottom: 40px; }
        .workspace { flex-grow: 1; background-color: #111; position: relative; overflow: auto; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        /* ROBLOX EKRANI */
        .roblox-screen { 
            width: 1280px; height: 720px; background: #000; border: 4px solid #444; position: relative; flex-shrink: 0;
            transform: scale(0.65); transform-origin: top center; box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        /* ELEMENTLER */
        .ui-element { position: absolute; display: flex; align-items: center; justify-content: center; cursor: grab; box-sizing: border-box; text-align: center; overflow: hidden; white-space: nowrap; }
        .ui-element.selected { outline: 2px solid var(--primary); outline-offset: 4px; z-index: 999 !important; }
        .resizer { width: 14px; height: 14px; background: white; position: absolute; right: 0; bottom: 0; cursor: nwse-resize; border: 2px solid var(--primary); border-radius: 2px; }
        .icon-img { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }

        /* BUTON ANƒ∞MASYONLARI */
        .is-button { transition: transform 0.1s, filter 0.1s; cursor: pointer; }
        .is-button:hover { filter: brightness(1.2); }
        .is-button:active { transform: scale(0.92) !important; }

        /* KOD MODAL */
        #code-modal {
            position: fixed; right: -600px; top: 0; width: 550px; height: 100vh; background: #111; border-left: 3px solid var(--primary);
            z-index: 2000; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); padding: 20px; box-sizing: border-box; display: flex; flex-direction: column;
        }
        #code-modal.open { right: 0; }
        #lua-code-area { flex-grow: 1; background: #050505; color: #dcdcaa; padding: 15px; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 13px; overflow: auto; white-space: pre; border: 1px solid #333; }

        /* FORM */
        .prop-group { background: #252525; padding: 12px; border-radius: 8px; border: 1px solid #383838; }
        .prop-group label { display: block; font-size: 0.65rem; color: #888; font-weight: bold; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
        input, select { width: 100%; background: #111; border: 1px solid #444; color: white; padding: 8px; border-radius: 4px; box-sizing: border-box; font-size: 0.85rem; }
        .btn-main { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; width: 100%; }
        .btn-main:hover { opacity: 0.9; }
        
        .layer-item { background: #222; padding: 10px; margin-bottom: 5px; border-radius: 5px; font-size: 12px; border-left: 4px solid transparent; cursor: pointer; display: flex; justify-content: space-between; }
        .layer-item.active { border-left-color: var(--primary); background: #2a2a2a; }

        #test-exit { display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 3000; background: #e74c3c; padding: 15px 40px; border-radius: 50px; border: none; color: white; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

    <button id="test-exit" onclick="toggleTestMode(false)">‚èπ TEST MODUNDAN √áIK</button>

    <div id="code-modal">
        <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom:15px;">
            <h2 style="margin:0; color:var(--primary);">üìú Generated Lua Script</h2>
            <button onclick="closeConsole()" style="background:none; border:none; color:white; font-size:28px; cursor:pointer;">&times;</button>
        </div>
        <div id="lua-code-area"></div>
        <button onclick="copyToClipboard()" class="btn-main" style="margin-top:15px; background:var(--accent);">üìã KODU KOPYALA</button>
    </div>

    <div class="sidebar">
        <button onclick="toggleTestMode(true)" style="background:#f1c40f; color:black; margin-bottom:10px;" class="btn-main">‚ñ∂ TEST MODU</button>
        <h3 style="font-size: 0.9rem; color: #666;">Bƒ∞LE≈ûENLER</h3>
        <button onclick="addElement('Frame')" class="btn-main" style="background:#333;">üñºÔ∏è Frame</button>
        <button onclick="addElement('TextButton')" class="btn-main" style="background:#333;">üîò TextButton</button>
        <button onclick="addElement('TextLabel')" class="btn-main" style="background:#333;">üìÑ TextLabel</button>
        <button onclick="addElement('ImageLabel')" class="btn-main" style="background:#333;">üñºÔ∏è ImageLabel</button>
        
        <h3 style="margin-top:20px; font-size: 0.9rem; color: #666;">KATMANLAR</h3>
        <div id="layer-list"></div>
    </div>

    <div class="workspace" onclick="select(null)">
        <div class="roblox-screen" id="viewport" onclick="event.stopPropagation()"></div>
    </div>

    <div class="properties">
        <h2 style="font-size: 1.1rem; border-bottom: 2px solid var(--primary); padding-bottom: 8px;">√ñzellikler</h2>
        <div id="prop-inputs" style="display:none;">
            
            <div class="prop-group">
                <label>Kimlik & Metin</label>
                <input type="text" id="p-name" oninput="apply()" placeholder="Obje Adƒ±" style="margin-bottom:8px;">
                <input type="text" id="p-text" oninput="apply()" placeholder="G√∂r√ºnen Metin">
            </div>

            <div class="prop-group">
                <label>G√∂rsel (Sadece ImageLabel)</label>
                <input type="text" id="p-icon" oninput="apply()" placeholder="Asset ID (√ñrn: 6031075929)">
            </div>
            
            <div class="prop-group">
                <label>Yazƒ± Fontu & Boyutu</label>
                <select id="p-font" onchange="apply()" style="margin-bottom:8px;">
                    <option value="Arial">Arial</option>
                    <option value="ArialBold">ArialBold</option>
                    <option value="Gotham">Gotham</option>
                    <option value="GothamBold">GothamBold</option>
                    <option value="GothamBlack">GothamBlack</option>
                    <option value="Roboto">Roboto</option>
                    <option value="SourceSans">SourceSans</option>
                    <option value="SourceSansBold">SourceSansBold</option>
                    <option value="Arcade">Arcade</option>
                    <option value="Fantasy">Fantasy</option>
                    <option value="SciFi">SciFi</option>
                    <option value="Cartoon">Cartoon</option>
                    <option value="Code">Code</option>
                    <option value="LuckiestGuy">LuckiestGuy</option>
                </select>
                <div style="display:flex; gap:8px; align-items:center;">
                    <input type="color" id="p-tcolor" oninput="apply()" title="Yazƒ± Rengi">
                    <input type="number" id="p-tsize" oninput="apply()" placeholder="Boyut">
                </div>
                <div style="margin-top:8px; display:flex; align-items:center; gap:5px;">
                    <input type="checkbox" id="p-tscaled" onchange="apply()" style="width:16px;"> 
                    <span style="font-size:0.7rem;">TextScaled (Otomatik Boyut)</span>
                </div>
            </div>

            <div class="prop-group">
                <label>G√∂r√ºn√ºm & Yuvarlaklƒ±k</label>
                <div style="display:flex; gap:8px; margin-bottom:8px;">
                    <input type="color" id="p-c1" oninput="apply()">
                    <div style="display:flex; align-items:center; gap:4px;">
                        <input type="checkbox" id="p-trans" onchange="apply()" style="width:16px;"> 
                        <span style="font-size:0.7rem;">≈ûeffaf</span>
                    </div>
                </div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:8px;">
                    <div><label>Corner Radius</label><input type="number" id="p-radius" oninput="apply()"></div>
                    <div><label>Stroke Kalƒ±nlƒ±k</label><input type="number" id="p-sthick" oninput="apply()"></div>
                </div>
            </div>

            <div class="prop-group">
                <label>Z-Index (Katman Sƒ±rasƒ±)</label>
                <input type="number" id="p-z" oninput="apply()">
            </div>

            <button onclick="duplicateElement()" class="btn-main" style="background:#8e44ad; margin-bottom:8px;">üë• KOPYALA (DUPLICATE)</button>
            <button onclick="generateLua()" class="btn-main" style="background:var(--accent);">üì• LUA KODU AL (F10)</button>
            <button onclick="deleteSelected()" class="btn-main" style="background:#e74c3c; margin-top:8px;">üóëÔ∏è ELEMENTƒ∞ Sƒ∞L</button>
        </div>
    </div>

<script>
    let elements = [];
    let selectedId = null;
    let isTestMode = false;

    // F10 Kƒ±sayolu
    window.addEventListener('keydown', (e) => { if (e.key === 'F10') { e.preventDefault(); generateLua(); } });

    // --- AUTO-SAVE ---
    function save() { localStorage.setItem('titan_ui_v27', JSON.stringify(elements)); }
    function load() { 
        const d = localStorage.getItem('titan_ui_v27');
        if(d) { elements = JSON.parse(d); render(); }
    }

    function addElement(type) {
        let id = "el_" + Math.floor(Math.random()*100000);
        elements.push({
            id: id, type: type, name: type + "_" + elements.length,
            text: type.includes('Text') ? 'Metin Buraya' : '',
            icon: type === 'ImageLabel' ? '6031075929' : '',
            font: 'Gotham', tSize: 18, tColor: '#ffffff', tScaled: false,
            c1: '#333333', transparent: (type === 'TextLabel'),
            sColor: '#00a2ff', sThick: 0,
            w: 180, h: 60, x: 100, y: 100, radius: 8, z: elements.length + 1
        });
        select(id);
        save();
    }

    function render() {
        const view = document.getElementById('viewport');
        view.innerHTML = '';
        const list = document.getElementById('layer-list');
        list.innerHTML = '';

        elements.sort((a,b) => a.z - b.z).forEach(el => {
            const div = document.createElement('div');
            const isBtn = el.type === 'TextButton';
            div.className = `ui-element ${isBtn ? 'is-button' : ''} ${selectedId === el.id ? 'selected' : ''}`;
            
            let bg = el.transparent ? 'transparent' : el.c1;
            let stroke = el.sThick > 0 ? `border: ${el.sThick}px solid ${el.sColor};` : '';
            let radius = el.radius > 0 ? `border-radius: ${el.radius}px;` : '';
            
            div.style = `left:${el.x}px; top:${el.y}px; width:${el.w}px; height:${el.h}px; z-index:${el.z}; background:${bg}; color:${el.tColor}; ${stroke} ${radius}`;
            
            // Font Ayarƒ±
            div.style.fontFamily = el.font.includes('Gotham') ? 'sans-serif' : el.font;
            div.style.fontWeight = el.font.includes('Bold') || el.font.includes('Black') ? 'bold' : 'normal';

            if(el.type === 'ImageLabel' && el.icon) {
                const img = document.createElement('img');
                img.className = 'icon-img';
                img.src = `https://www.roblox.com/asset-thumbnail/image?assetId=${el.icon}&width=420&height=420&format=png`;
                div.appendChild(img);
            }

            if(el.text) {
                const span = document.createElement('span');
                span.innerText = el.text;
                if(el.tScaled) {
                    span.style.fontSize = "min(10vw, 80%)";
                    span.style.width = "90%";
                } else {
                    span.style.fontSize = el.tSize + "px";
                }
                div.appendChild(span);
            }
            
            if(!isTestMode) {
                const r = document.createElement('div'); r.className = 'resizer';
                r.onmousedown = (e) => startResize(e, el);
                div.appendChild(r);
                div.onmousedown = (e) => { e.stopPropagation(); startDrag(e, el); };
                div.onclick = (e) => { e.stopPropagation(); select(el.id); };
            }
            view.appendChild(div);

            const li = document.createElement('div');
            li.className = `layer-item ${selectedId === el.id ? 'active' : ''}`;
            li.innerHTML = `<span>${el.name}</span> <small style="opacity:0.5">${el.type}</small>`;
            li.onclick = () => select(el.id);
            list.appendChild(li);
        });
    }

    function select(id) {
        selectedId = id;
        const el = elements.find(e => e.id === id);
        const panel = document.getElementById('prop-inputs');
        if(el) {
            panel.style.display = 'block';
            document.getElementById('p-name').value = el.name;
            document.getElementById('p-text').value = el.text;
            document.getElementById('p-icon').value = el.icon || '';
            document.getElementById('p-font').value = el.font;
            document.getElementById('p-tcolor').value = el.tColor;
            document.getElementById('p-tsize').value = el.tSize;
            document.getElementById('p-tscaled').checked = el.tScaled;
            document.getElementById('p-c1').value = el.c1;
            document.getElementById('p-trans').checked = el.transparent;
            document.getElementById('p-radius').value = el.radius;
            document.getElementById('p-sthick').value = el.sThick;
            document.getElementById('p-z').value = el.z;
        } else { panel.style.display = 'none'; }
        render();
    }

    function apply() {
        const el = elements.find(e => e.id === selectedId);
        if(!el) return;
        el.name = document.getElementById('p-name').value;
        el.text = document.getElementById('p-text').value;
        el.icon = document.getElementById('p-icon').value;
        el.font = document.getElementById('p-font').value;
        el.tColor = document.getElementById('p-tcolor').value;
        el.tSize = parseInt(document.getElementById('p-tsize').value) || 14;
        el.tScaled = document.getElementById('p-tscaled').checked;
        el.c1 = document.getElementById('p-c1').value;
        el.transparent = document.getElementById('p-trans').checked;
        el.radius = parseInt(document.getElementById('p-radius').value) || 0;
        el.sThick = parseInt(document.getElementById('p-sthick').value) || 0;
        el.z = parseInt(document.getElementById('p-z').value) || 1;
        render();
        save();
    }

    function generateLua() {
        let code = `-- [ Roblox UI Titan v2.7 ] --\nlocal sg = Instance.new("ScreenGui", game.Players.LocalPlayer.PlayerGui)\nsg.Name = "TitanGeneratedGui"\nsg.ResetOnSpawn = false\n`;
        elements.forEach(el => {
            code += `\n-- [[ ${el.name} ]]\nlocal ${el.id} = Instance.new("${el.type}", sg)\n`;
            code += `${el.id}.Name = "${el.name}"\n`;
            code += `${el.id}.Size = UDim2.new(0, ${Math.round(el.w)}, 0, ${Math.round(el.h)})\n`;
            code += `${el.id}.Position = UDim2.new(0, ${Math.round(el.x)}, 0, ${Math.round(el.y)})\n`;
            code += `${el.id}.BackgroundColor3 = Color3.fromHex("${el.c1}")\n`;
            code += `${el.id}.ZIndex = ${el.z}\n`;
            if(el.transparent) code += `${el.id}.BackgroundTransparency = 1\n`;
            if(el.text) {
                code += `${el.id}.Text = "${el.text}"\n`;
                code += `${el.id}.Font = Enum.Font.${el.font}\n`;
                code += `${el.id}.TextScaled = ${el.tScaled}\n`;
                if(!el.tScaled) code += `${el.id}.TextSize = ${el.tSize}\n`;
                code += `${el.id}.TextColor3 = Color3.fromHex("${el.tColor}")\n`;
            }
            if(el.type === 'ImageLabel') {
                code += `${el.id}.Image = "rbxassetid://${el.icon}"\n`;
            }
            if(el.radius > 0) {
                code += `local corner = Instance.new("UICorner", ${el.id})\ncorner.CornerRadius = UDim.new(0, ${el.radius})\n`;
            }
            if(el.sThick > 0) {
                code += `local stroke = Instance.new("UIStroke", ${el.id})\nstroke.Thickness = ${el.sThick}\nstroke.Color = Color3.fromHex("${el.sColor}")\n`;
            }
        });
        document.getElementById('lua-code-area').innerText = code;
        document.getElementById('code-modal').classList.add('open');
    }

    function toggleTestMode(v) {
        isTestMode = v;
        select(null);
        document.getElementById('test-exit').style.display = v ? 'block' : 'none';
        render();
    }

    function startDrag(e, el) {
        let ox = e.clientX / 0.65 - el.x, oy = e.clientY / 0.65 - el.y;
        const move = (ev) => { el.x = ev.clientX / 0.65 - ox; el.y = ev.clientY / 0.65 - oy; render(); save(); };
        const stop = () => document.removeEventListener('mousemove', move);
        document.addEventListener('mousemove', move); document.addEventListener('mouseup', stop);
    }

    function startResize(e, el) {
        e.stopPropagation();
        const move = (ev) => {
            const rect = document.getElementById('viewport').getBoundingClientRect();
            el.w = (ev.clientX - rect.left) / 0.65 - el.x;
            el.h = (ev.clientY - rect.top) / 0.65 - el.y;
            render(); save();
        };
        const stop = () => document.removeEventListener('mousemove', move);
        document.addEventListener('mousemove', move); document.addEventListener('mouseup', stop);
    }

    function duplicateElement() {
        const original = elements.find(e => e.id === selectedId);
        if(!original) return;
        const copy = JSON.parse(JSON.stringify(original));
        copy.id = "el_" + Math.floor(Math.random()*100000);
        copy.name += "_Copy"; copy.x += 30; copy.y += 30;
        elements.push(copy);
        select(copy.id);
        save();
    }

    function deleteSelected() { elements = elements.filter(e => e.id !== selectedId); select(null); save(); }
    function closeConsole() { document.getElementById('code-modal').classList.remove('open'); }
    function copyToClipboard() { navigator.clipboard.writeText(document.getElementById('lua-code-area').innerText).then(() => alert("Lua kodu ba≈üarƒ±yla kopyalandƒ±!")); }

    load();
</script>
</body>
</html>
